# Conditional alias, only aliases if $2 is a valid command on the system
calias ()
{
	if [ -n "$(command -v $2)" ]; then
		alias $1="$2"
	elif [ -n "$3" -a "$(command -v $3)" ]; then
		alias $1="$3"
	fi
}

calias cnf_cols "$EDITOR $DIRCOLORS"
if [ "$EDITOR" = "vim" ] ; then
	calias cnf_defs "$EDITOR -O $DEFINES $DEFINES2"
else
	calias cnf_defs "$EDITOR $DEFINES $DEFINES2"
fi
calias cnf_alias "$EDITOR $ALIASRC"
calias cnf_sxhkd "$EDITOR $SXHKDRC"
calias cnf_xres "$EDITOR $XRESOURCES"
calias cnf_xprf "$EDITOR $XPROFILE"
calias cnf_xenv "$EDITOR $XENVIRONMENT"
calias cnf_xinit "$EDITOR ~/.xinitrc"
calias cnf_prf "$EDITOR ~/.profile"
calias cc_defines "cc -dM -E - < /dev/null"
calias gcc_defines "gcc -dM -E - < /dev/null"

calias bashp "source ~/.bash_profile"
calias vfc "$EDITOR ~/.vim/vimrc"
calias vi "$EDITOR"

calias ftpstat "sudo systemctl status vsftpd"
calias restarteth "sudo modprobe -r r8168; sudo modprobe r8168"
calias memcheck "valgrind --tool=memcheck --read-var-info=yes --leak-check=full --show-leak-kinds=all --track-origins=yes -s"
calias massif "valgrind --tool=massif --max-snapshots=1000 --detailed-freq=1 --stacks=yes --read-var-info=yes -s"
calias cmd "wine cmd"

calias du "du -cs --si"
calias df "df --si"
calias objdump "objdump --source --line-numbers -w -Mintel"
calias wget "wget -v --show-progress --timestamping --no-cookies --compression=auto \
--hsts-file="$CONFIGDIR"/wget/hsts --convert-links --append-output="$LOGDIR"/wget"
calias dlpage "dlpage -l "$LOGDIR"/wget -h "$CONFIGDIR"/wget/hsts"
calias feh "feh --force-aliasing --keep-zoom-vp --zoom-fill"
calias patch "patch -b"
calias kdiff3 "kdiff3 --qall"
calias nvidia-settings "nvidia-settings --config=~/.config/nvidia-settings-rc"
calias pacgraph "pacgraph -b black -l cyan -t green -d red -p 12 60"

calias mcnf "vim -p ~/.config/aliasrc ~/.config/dircolors ~/.config/xconf/"
calias mxnf "vim -p $XPROFILE2 $XPROFILE"
calias sizes "du ./* ./.*  -h | sort -h"
calias wineexplorer "wine explorer"
calias zult "lrztar -L 9 -z -p 1 -U" "7z a -t7z -m0=lzma2 -mx=9 -mfb=64 -md=32m -ms=on"
calias clock "date +'%a, %02m/%02d/%y, %02I:%02M:%02S'"

# yay
calias yss "yay -Ss"
calias yqs "yay -Qs"
calias yrs "yay -Rns"
calias yqo "yay -Qo"
# List the size of all installed packages, sorted least-to-most size.
calias yaysizes "yay -Qi | awk '/^Name/{name=\$3} /^Installed Size/{print \$4\$5, name}' | sort -h"

calias grep "grep --color=auto -E"

alias itemsizes="du --exclude='..' --exclude='.' ./{.,}*"

# Currently, safe-rm and safe-rmdir don't quite work the way I want.
# I'd like it to be so that if I blacklist a folder like '/root/**',
# all subdirectories and files will also be blacklisted. Instead, it only does
# 'recursive' blacklisting to a depth of 1.
# TODO fix
if [ -n "$(command -v safe-rm)" ] ; then
	alias rm="safe-rm -vi --preserve-root"
	alias rmdir="safe-rmdir -v"
else
	alias rm="rm -vi --preserve-root"
	alias rmdir="rmdir -v"
fi

# -- TYPOS
alias caelr="clear"
alias caerl="clear"
alias carel="clear"
alias crael="clear"
alias rcael="clear"
alias cealr="clear"
alias cearl="clear"
alias ceral="clear"
alias creal="clear"
alias rceal="clear"
alias caler="clear"
alias calre="clear"
alias carle="clear"
alias crale="clear"
alias rcale="clear"
alias celar="clear"
alias celra="clear"
alias cerla="clear"
alias crela="clear"
alias rcela="clear"
alias claer="clear"
alias clare="clear"
alias clrae="clear"
alias crlae="clear"
alias rclae="clear"
alias clera="clear"
alias clrea="clear"
alias clrea="clear"
alias rclea="clear"
alias cd..="cd .."

# -- DEFAULT SETTINGS

# TODO replace ls with a script that uses stat to generate a listing.
#	Give it an option to do normal 'ls' instead.
# On my system,     'ls -s'  prints the logical size/allocated space.
# The size shown by 'ls -l'  prints the actual physical size taken up on disk.
# 'ls -ls' prints what 'ls -l' prints.
# General rules:
#  Capital first letter:  '-1' is passed to 'ls' (single column)
#  Capital second letter: '-s' is passed to 'ls'
#  The argument that matches the second letter is always passed (except for ls)
alias ls="ls -xCNF --si --color=auto --group-directories-first --time-style=long-iso"
alias Ls="ls -1"
alias lS="ls -s"
alias LS="ls -1s"

alias la="ls -a"
alias La="ls -1a"
alias lA="ls -sA"
alias LA="ls -1sA"

alias ll="ls -ls"
alias Ll="ls -1ls"
alias lL="ls -ls"
alias LL="ls -1lsA"
alias LLL="ls -1lsa"

alias l="ls"
alias L="ls -1"

alias less="less --LINE-NUMBERS"
calias xstart "startx > $LOGDIR/xlog 2>&1"

# git stuff
calias ga   "git add"
calias gck  "git checkout"
calias gam  "git commit --amend --no-edit"
calias guc  "git reset HEAD~1"
calias gc   "git commit"
calias gp   "git push"
calias gd   "git diff"
calias gdc  "git diff --cached"
calias gs   "git status"
calias gl   "git log"
calias gls  "git log --stat"
calias gap  "git add --patch"
calias grs  "git restore --staged"
calias grb  "git rebase -i HEAD~10"
calias gsu  "git submodule update"
calias gsui "git submodule update --init"
calias gsur "git submodule update --remote"
calias gsurm"git submodule update --remote --merge"
calias gsuR "git submodule update --recursive"
calias gss  "git submodule status"
calias gsi  "git submodule init"

alias locallib="LD_LIBRARY_PATH=."

calias ytdl "youtube-dl --continue --ignore-errors"
calias yt-album-dl "youtube-dl --verbose --continue --ignore-errors --extract-audio \
	--output \"%(playlist_index)s - %(title)s.%(ext)s\" --audio-format best"
calias bcdl "bandcamp-dl -ry"
calias neofetch "neofetch --cpu_speed on --cpu_cores logical --cpu_brand on \
	--cpu_temp C --distro_shorthand of --kernel_shorthand off \
	--uptime_shorthand off --refresh_rate on --gpu_brand on --gpu_type all \
	--de_version on --gtk_shorthand off --gtk2 on --gtk3 on --shell_path on \
	--shell_version on --disk_percent on --memory_percent on --os_arch on \
	--package_managers on --speed_shorthand off --underline on --bold on \
	--block_height 1 --block_width 2 --cpu_display infobar \
	--memory_display infobar --battery_display infobar --disk_display infobar \
	--bar_char '#' '-'"

unset calias

mcd()
{
	#$1=dir
	dir="$1"
	shift
	[ ! -d "$dir" ] && mkdir $@ "$dir" || return 1
	cd "$dir" || return 1
}
